{% extends 'base.html' %}

{% block titlename %}
<title>Articles</title>
<style>
    form {
        display: flex;
        /* form 안의 요소들이 한 줄로 나열되도록 설정 */
        align-items: center;
        /* 수직 중앙 정렬 */
        gap: 10px;
        /* 요소들 간의 간격 */
    }

    .container {
        --bs-primary-rgb: 13, 110, 253;
        --bs-secondary-rgb: 108, 117, 125;
        --bs-success-rgb: 25, 135, 84;
        --bs-info-rgb: 13, 202, 240;
        --bs-warning-rgb: 255, 193, 7;
        --bs-danger-rgb: 220, 53, 69;
        --bs-light-rgb: 248, 249, 250;
        --bs-dark-rgb: 33, 37, 41;
        --bs-white-rgb: 255, 255, 255;
        --bs-black-rgb: 0, 0, 0;
        --bs-breakpoint-sm: 576px;
        --bs-breakpoint-md: 768px;
        --bs-breakpoint-lg: 992px;
        --bs-breakpoint-xl: 1500px;
        --bs-breakpoint-xxl: 1700px;
        font-family: var(--bs-body-font-family);
        font-size: var(--bs-body-font-size);
        font-weight: var(--bs-body-font-weight);
        line-height: var(--bs-body-line-height);
        color: var(--bs-body-color);
        text-align: var(--bs-body-text-align);
        -webkit-text-size-adjust: 100%;
        -webkit-tap-highlight-color: transparent;
        box-sizing: border-box;
        --bs-gutter-x: 1.5rem;
        --bs-gutter-y: 0;
        width: 100%;
        padding-right: calc(var(--bs-gutter-x) * .5);
        padding-left: calc(var(--bs-gutter-x) * .5);
        margin-right: auto;
        margin-left: auto;
        max-width: 1560px;
    }
</style>
{% endblock titlename %}

{% block content %}
<div>
    <h2 style="display: inline;">Articles</h2>
    {% if request.user.is_authenticated %}
    <a href="{% url 'articles:create' %}"><button class="btn btn-sm">글 쓰러 가기</button></a><br><br>
    {% else %}
    <a href="{% url 'articles:create' %}"><button class="btn btn-sm">로그인 하고 글 쓰러 가기</button></a><br><br>
    {% endif %}

    <div class="album py-5 bg-body-tertiary">
        <div class="container">
            <div
                class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 row-cols-xl-5 row-cols-xxl-6 g-2 g-1g-3">
                <!-- <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3"> -->
                {% for article in articles %}
                <div class="col"
                    onclick="event.stopPropagation(); window.location.href='{% url 'articles:article_detail' article.pk %}'">
                    <div class="card shadow-sm" style="overflow: hidden;">
                        {% if article.image %}
                        <img class="bd-placeholder-img card-img-top" width="100%" height="225"
                            src="{{ article.image.url }}" alt="none" style="object-fit: cover;">
                        {% else %}
                        <svg class="bd-placeholder-img card-img-top" width="100%" height="225"
                            xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: Thumbnail"
                            preserveAspectRatio="xMidYMid slice" focusable="false">
                            <title>Placeholder</title>
                            <rect width="100%" height="100%" fill="#55595c"></rect><text x="50%" y="50%" fill="#eceeef"
                                dy=".3em">Thumbnail</text>
                        </svg>
                        {% endif %}
                        <div class="card-body">
                            <p class="card-text unbr" style="display: inline-block;">{{ article.title }}</p>
                            <p class="card-text unbr" style="display: inline-block;">test</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="btn-group">
                                    {% if request.user.id == article.author.id %}
                                    <button type="button" class="btn btn-sm btn-outline-secondary"
                                        onclick=" event.stopPropagation(); window.location.href='{% url 'articles:update' article.pk %}'">Edit</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary"
                                        onclick="event.stopPropagation();" data-bs-toggle="modal"
                                        data-bs-target="#exampleModal{{article.pk}}">Delete</button>

                                    <!-- data-bs-target을 부름 exampleModal{{article.pk}}을 튀어나오게함 -->
                                    {% endif %}
                                    <form action="{% url 'articles:like' article.pk %}" method="POST"
                                        class="btn btn-outline-secondary" style="padding: 0%;">
                                        {% csrf_token %}
                                        {% if user in article.like_users.all %}
                                        <button type="submit" onclick="event.stopPropagation();"
                                            class="btn btn-sum text-danger"><i class="fa-solid fa-heart"></i></button>
                                        {% else %}
                                        <button type="submit" onclick="event.stopPropagation();"
                                            class="btn btn-sum text-danger"><i class="fa-regular fa-heart"></i></button>
                                        {% endif %}
                                    </form>
                                </div>
                                <small class="text-body-secondary">{{ article.time_dif }}</small>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 모달창     id의 exampleModal을 부름     -->
                <div class="modal fade" id="exampleModal{{article.pk}}" tabindex="-1"
                    aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5" id="exampleModalLabel">Modal title</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                ...
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                <form action="{% url 'articles:delete' article.pk %}" method="post">
                                    {% csrf_token %}
                                    <button type="submit" class="btn btn-primary">Delete</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}

            </div>
        </div>
    </div>
</div>


{% endblock content %}